<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Tap Counter</title>

  <link rel="stylesheet" href="assets/bootstrap-5.3.3-dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/fontawesome-free-6.5.2-web/css/all.min.css">
  <link rel="stylesheet" href="assets/custom/style.css">

  <script src="assets/jquery-3.7.1/jquery.min.js"></script>
  <script src="assets/bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
  <script src="assets/fontawesome-free-6.5.2-web/js/all.min.js"></script>
  <script src="assets/custom/script.js"></script>

</head>

<body class="dark">
  <div class="config_btn_container text-end">
    <div id="reset_counter_btn" class="btn btn-success config_btn" title="Reset All Counter"
      onclick="resetAllCounter()">
      <i class="fas fa-undo-alt"></i><span class="config_btn_text"></span>
    </div>

    <div id="dark_theme_btn" class="btn btn-dark config_btn" title="Dark Theme" onclick="switchTheme(`light`)">
      <i class="far fa-moon"></i><span class="config_btn_text"></span>
    </div>

    <div id="light_theme_btn" class="btn btn-light d-none config_btn" title="Light Theme" onclick="switchTheme(`dark`)">
      <i class="far fa-sun"></i><span class="config_btn_text"></span>
    </div>
  </div>

  <div class="background_container">
    <div class="image_container">
      <img id="bg_image" src="assets/images/transparent.png" alt="">
    </div>
  </div>

  <div id="one_panel" class="panel" onclick="tap(`one`)">
    <div id="one_counter" class="counter">0</div>
  </div>

  <div id="two_verti_panel" class="panel d-none"></div>

  <div id="two_hori_panel" class="panel d-none"></div>

  <div id="four_panel" class="panel d-none"></div>

</body>

</html>

<script>
  $(document).ready(function () {
    // Your initialization or other code here
    initApp();
  });

  var oneCounter = 0;
  var twoHoriCounter = [];
  var twoVertiCounter = [];
  var fourCounter = [];
  var animationTimer = null;

  // function to check if there's saved settings on local storage
  // if there is, apply them to the app
  function initApp() {
    // take all those saved value and apply them to each element respectively
    // check for theme setting
    const themeSetting = getFromLocal('tap_counter_theme', 'dark');
    if (themeSetting == 'dark') {
      $('#light_theme_btn').addClass('d-none');
      $('#dark_theme_btn').removeClass('d-none');
    } else {
      $('#light_theme_btn').removeClass('d-none');
      $('#dark_theme_btn').addClass('d-none');
    }
    $('body').removeClass().addClass(themeSetting);

    // check counter value of one_panel
    const oneCounterValue = getFromLocal('tap_counter_value_one_counter', 0);
    $('#one_counter').text(oneCounterValue);
  }

  // function to handle click on one_panel
  function tap(param = "one", side = null) {
    const sideKey = (side == null) ? "" : side;
    const counterId = param + sideKey + '_counter';
    const counterElement = $('#' + counterId);

    let currentCounter = parseInt(counterElement.text());
    newCounter = currentCounter + 1;
    counterElement.text(newCounter);

    saveToLocal('tap_counter_value_' + counterId, newCounter);

    counterElement.addClass('enlarge');

    if (animationTimer) {
      clearTimeout(animationTimer);
    }

    animationTimer = setTimeout(() => {
      counterElement.removeClass('enlarge');
    }, 300);
  }

  function resetAllCounter(param, side = null) {
    $('#one_counter').text(0);
    saveToLocal('tap_counter_value_one_counter', 0);
  }

  function switchTheme(param) {
    $('body').removeClass().addClass(param);
    saveToLocal('tap_counter_theme', param);

    if (param == 'dark') {
      $('#light_theme_btn').addClass('d-none');
      $('#dark_theme_btn').removeClass('d-none');
    } else {
      $('#light_theme_btn').removeClass('d-none');
      $('#dark_theme_btn').addClass('d-none');
    }
  }

</script>